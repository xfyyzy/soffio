{% extends "admin/layouts/panel.html" %}

{% block panel_id %}api-key-new{% endblock %}
{% block panel_heading %}{{ content.heading }}{% endblock %}

{% block panel_toolbar %}{% endblock panel_toolbar %}

{% block panel_controls %}
{% if let Some(token) = content.new_token %}
  <div data-role="card" data-variant="highlight">
    <p><strong>New key</strong></p>
    <p style="word-break: break-all;">{{ token }}</p>
    <p class="muted">Copy now â€” it won't be shown again.</p>
  </div>
{% endif %}
{% endblock panel_controls %}

{% block panel_content %}
  {% let picker = content.scope_picker.clone() %}
  <form id="api-key-form" data-role="api-key-editor" method="post" action="{{ content.form_action }}"
        data-on-submit__prevent="(@post(`{{ content.form_action }}`, { contentType: 'form' }))">
    <label>
      <span>Name</span>
      <input type="text" name="name" value="{% if let Some(v) = &content.name %}{{ v }}{% endif %}" required>
    </label>
    <label>
      <span>Description</span>
      <textarea name="description" rows="3" placeholder="Optional purpose">{% if let Some(v) = &content.description %}{{ v }}{% endif %}</textarea>
    </label>
    <label>
      <span>Expires in</span>
      <select name="expires_in">
        {% for option in content.expires_in_options %}
        <option value="{{ option.value }}" {% if option.selected %}selected{% endif %}>{{ option.label }}</option>
        {% endfor %}
      </select>
    </label>
  </form>
  {% include "admin/api_key_scope_picker.html" %}
  <div data-role="form-actions">
    <button type="submit" form="api-key-form">Create key</button>
  </div>
{% endblock panel_content %}
