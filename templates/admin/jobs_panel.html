{% extends "admin/layouts/panel.html" %}

{% block panel_id %}jobs{% endblock %}

{% block panel_heading %}{{ content.heading }}{% endblock %}

{% block panel_toolbar %}
{% endblock panel_toolbar %}

{% block panel_controls %}
{% let panel_action = content.panel_action %}
{% include "admin/partials/status_tabs.html" %}
{% include "admin/partials/jobs_filter_form.html" %}
{% endblock panel_controls %}

{% block panel_content %}
{% let panel_action = content.panel_action %}
{% let row_action_prefix = content.row_action_prefix %}
<table data-role="publishable-table">
    <thead>
        <tr>
            <th scope="col" data-column="job-id">ID</th>
            <th scope="col" data-column="job-type">Type</th>
            <th scope="col" data-column="job-state">State</th>
            <th scope="col">Attempts</th>
            <th scope="col">Run At</th>
            <th scope="col">Done At</th>
            <th scope="col">Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for item in content.jobs %}
        <tr data-role="job-row" data-job-id="{{ item.id }}">
            <td data-column="job-id">
                <a href="{{ item.detail_href }}" title="{{ item.id }}">{{ item.id }}</a>
            </td>
            <td data-column="job-type"><status-badge data-status="{{ item.job_type_key }}">{{ item.job_type_label
                    }}</status-badge></td>
            <td data-column="job-state"><status-badge data-status="{{ item.state_key }}">{{ item.state_label
                    }}</status-badge></td>
            <td>{{ item.attempts }}</td>
            <td>{{ item.run_at }}</td>
            <td>
                {% if let Some(time) = &item.done_at %}{{ time }}{% else %}<span data-role="muted">â€”</span>{% endif %}
            </td>
            <td data-role="publishable-actions">
                {% include "admin/partials/job_row_actions.html" %}
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% include "admin/partials/pagination.html" %}
{% endblock panel_content %}